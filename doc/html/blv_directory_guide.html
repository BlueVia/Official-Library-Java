<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SDK: Directory API guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SDK&#160;<span id="projectnumber">1.6</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('blv_directory_guide.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Directory API guide </div>  </div>
</div>
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="directory_abstract_sec"></a>
Abstract</h2>
<p>The Bluevia Directory API is a set of functions which allows users to retrieve user-related information, divided in four blocks (user profile, access information, personal information and terminal information). This guide represents a practical introduction to developing applications in which the user wants to provide the Bluevia Directory functionality.</p>
<h2><a class="anchor" id="blv_directory_api_retrievings_ads_sec"></a>
Bluevia Directory API: Accessing Directory information</h2>
<p>The Bluevia Directory API is a set of functions which allows users to retrieve user-related information, divided in four blocks (user profile, access information, personal information and terminal information). This guide represents a practical introduction to developing applications in which the user wants to provide the Bluevia Directory functionality.</p>
<h3><a class="anchor" id="directory_client_basics_sec"></a>
Directory client basics</h3>
<p>A Directory client represents the client side in a classic client-server schema. This object wraps up the underlying REST client side functionality needed to perform requests against a REST server.</p>
<p>Any Bluevia client performs requests and receives responses in a secure mode. Clients are authorized following the OAuth protocol. This security protocol enables users to grant third-party access to their resources without sharing their passwords. So clients store the authorization data -called security credentials- to grant access to the server. Following sections describe the security credentials we are talking about.</p>
<h3><a class="anchor" id="creating_directory_client_sec"></a>
Creating a Directory client: BVDirectory class</h3>
<p>The first step in using the Directory client is to create an BVDirectory object. As we mentioned earlier this object could have three different working modes: i) as a client which sends requests to a real server, ii) a client working with a real server in testing mode, or iii) as a client which sends requests and receives responses to/from a sandbox server.</p>
<h4><a class="anchor" id="directoryclient_features_working_modes_sec"></a>
DirectoryClient features: working modes</h4>
<p>When you create the client, you can specify various working modes: </p>
<ul>
<li>
<p class="startli">BVBaseClient.Mode.LIVE <br/>
In the Live environment your application uses the real network, which means that you will be able to send real transactions to real Movistar, O2 and Vivo customers in the applicable country.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">BVBaseClient.Mode.TEST <br/>
The Test mode behave exactly like the Live mode, but the API calls are free of chargue, using a credits system. You are required to have a Movistar, O2 or Vivo mobile number to get this monthly credits.</p>
<p class="endli"></p>
</li>
<li>
BVBaseClient.Mode.SANDBOX <br/>
The Sandbox environment offers you the exact same experience as the Live environment except that no traffic is generated on the live network, meaning you can experiment and play until your heartâ€™s content. </li>
</ul>
<h4><a class="anchor" id="directoryclient_features_security_credentials"></a>
Directory client features: security credentials</h4>
<p>Bluevia uses OAuth as its authentication mechanism which enables websites and applications to access the Bluevia API's without end users disclosing their personal credentials. In order to grant access to the server any client has to be created passing the security credential as parameter in its constructor. These security credentials are managed internally and added as a HTTP header in every request sent to the server. Such Oauth security credentials are: </p>
<ul>
<li>
<p class="startli"><b>Consumer key</b> <br/>
The string identifying the application- you obtained when you registered your application within the provisioning portal.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Consumer secret</b> <br/>
A secret -a string- used by the consumer to establish ownership of the consumer key.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Access token</b> <br/>
The token -a string- used by the client for granting access permissions to the server.</p>
<p class="endli"></p>
</li>
<li>
<b>Access token secret</b> <br/>
The secret of the access token. </li>
</ul>
<h4><a class="anchor" id="directoryclient_features_code_example"></a>
Directory client features: code example</h4>
<p>Find below an example on how to create an BVDirectory object taking into account all information previously given.</p>
<div class="fragment"><pre class="fragment"><span class="comment">// Mode.LIVE indicating the client works against a real Bluevia server.</span>
<span class="keywordflow">try</span> {
        BVDirectory directoryClient = <span class="keyword">new</span> BVDirectory(Mode.LIVE, <span class="stringliteral">&quot;consumer_key&quot;</span>, <span class="stringliteral">&quot;consumer_secret&quot;</span>, <span class="stringliteral">&quot;access_token&quot;</span>, <span class="stringliteral">&quot;access_token_secret&quot;</span>);
} <span class="keywordflow">catch</span> (BlueviaException e){
        log.error(e.getMessage());
}
</pre></div><h4><a class="anchor" id="directoryclient_features_freeing_resources_sec"></a>
DirectoryClient features: freeing resources</h4>
<p>It is very important to free the resources that the client instantiates to work. To do this call the close method after finishing using the client:</p>
<div class="fragment"><pre class="fragment">directoryClient.close();
</pre></div><h3><a class="anchor" id="retrieving_user_info_sec"></a>
Retrieving User Info</h3>
<p>This method retrieves the whole user info resource block from the directory. User profile includes user profile, access, personal and terminal info blocks. The signature of the method is:</p>
<div class="fragment"><pre class="fragment">UserInfo getUserInfo() throws BlueviaException, IOException
</pre></div><p>Check the API Reference to see the information that can be obtained from the UserProfile returned object, accessible using getter methods.</p>
<h4><a class="anchor" id="retrieving_user_info_using_filters_sec"></a>
Selecting blocks in requests</h4>
<p>In case the user doesn't want to retrieve all blocks, there is an option to retrieve only a subset of the available information, using filters. An array of UserInfo.DataSet can be included in the request selecting the desired info blocks:</p>
<div class="fragment"><pre class="fragment">UserInfo getUserInfo(UserInfo.DataSet[] dataSet) throws BlueviaException, IOException
</pre></div><h4><a class="anchor" id="user_info_code_example_sec"></a>
Code examples</h4>
<p>This is a example for retrieving the whole user info block:</p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">try</span> {
        <span class="comment">//Get the UserInfo response</span>
        UserInfo info = directoryClient.getUserInfo();

        Profile profile = info.getProfile();
        AccessInfo accessInfo = info.getAccessInfo();
        PersonalInfo personalInfo = info.getPersonalInfo();
        TerminalInfo terminalInfo = info.getTerminalInfo();     
        
        <span class="comment">/* Get information and do stuff */</span>
          
} <span class="keywordflow">catch</span> (BlueviaException e) {
        log.error(<span class="stringliteral">&quot;Error getting user info&quot;</span>, e);
} <span class="keywordflow">catch</span> (IOException e) {
        log.error(<span class="stringliteral">&quot;Error getting user info&quot;</span>, e);
}
</pre></div><p>For filtering blocks, you have to include the data sets you want to retrieve. This is an example:</p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">try</span> {
        <span class="comment">//Select data sets</span>
        UserInfo.DataSet[] dataSet = {DataSet.ACCESS_INFO, DataSet.PERSONAL_INFO};
        
        <span class="comment">//Get the UserInfo response</span>
        UserInfo info = directoryClient.getUserInfo(dataSet);

        AccessInfo accessInfo = info.getAccessInfo();
        TerminalInfo terminalInfo = info.getTerminalInfo();     
        
        <span class="comment">/* Get information and do stuff */</span>
          
} <span class="keywordflow">catch</span> (BlueviaException e) {
        log.error(<span class="stringliteral">&quot;Error getting user info&quot;</span>, e);
} <span class="keywordflow">catch</span> (IOException e) {
        log.error(<span class="stringliteral">&quot;Error getting user info&quot;</span>, e);
}
</pre></div><p>Individual blocks can be obtained through its own method, as can be seen below:</p>
<h3><a class="anchor" id="retrieving_user_profile_sec"></a>
Retrieving user profile</h3>
<p>This method retrieves the user profile resource block from the directory. User profile includes payment options, subscription to services, customer type and other operator related information. The signature of the method is:</p>
<div class="fragment"><pre class="fragment">Profile getProfile() throws BlueviaException, IOException
</pre></div><p>Check the API Reference to see the information that can be obtained from the UserProfile returned object, accessible using getter methods.</p>
<h4><a class="anchor" id="retrieving_user_profile_using_filters_sec"></a>
Using filters in requests</h4>
<p>In case the user doesn't want to retrieve the whole block, there is an option to retrieve only a subset of the available information, using filters. An array of Profile.Fields can be included in the request selecting the desired info blocks:</p>
<div class="fragment"><pre class="fragment">Profile getProfile(Profile.Fields[] fields) throws BlueviaException, IOException
</pre></div><h4><a class="anchor" id="user_profile_code_example_sec"></a>
Code examples</h4>
<p>This is a example for retrieving the whole user profile block:</p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">try</span> {
        <span class="comment">//Get the Profile response</span>
        Profile profile = directoryClient.getProfile();

        <span class="comment">/* Get information and do stuff */</span>
          
} <span class="keywordflow">catch</span> (BlueviaException e) {
        log.error(<span class="stringliteral">&quot;Error getting user profile&quot;</span>, e);
} <span class="keywordflow">catch</span> (IOException e) {
        log.error(<span class="stringliteral">&quot;Error getting user profile&quot;</span>, e);
}
</pre></div><p>For filtering information, you have to include the fields you want to retrieve. This is an example:</p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">try</span> {
        <span class="comment">//Set the fields</span>
        Profile.Fields[] fields = {Fields.USER_TYPE, Fields.PARENTAL_CONTROL, Fields.OPERATOR_ID};
        
        <span class="comment">//Get the Profile response</span>
        Profile profile = directoryClient.getProfile(fields);

        <span class="comment">/* Get information and do stuff */</span>
        String userType = profile.getUserType();
          
} <span class="keywordflow">catch</span> (BlueviaException e) {
        log.error(<span class="stringliteral">&quot;Error getting user profile&quot;</span>, e);
} <span class="keywordflow">catch</span> (IOException e) {
        log.error(<span class="stringliteral">&quot;Error getting user profile&quot;</span>, e);
}
</pre></div><h3><a class="anchor" id="retrieving_user_access_info_sec"></a>
Retrieving user access information</h3>
<p>This method retrieves the whole user access information resource block from the directory. User access information correspond to the user connection profile and includes information like the access connection type, APN, roaming status, etc. The signature of the method is:</p>
<div class="fragment"><pre class="fragment">AccessInfo getAccessInfo() throws BlueviaException, IOException
</pre></div><p>Check the API Reference to see the information that can be obtained from the AccessInfo returned object, accessible by getters.</p>
<h4><a class="anchor" id="user_access_info_using_filters_sec"></a>
Using filters in requests</h4>
<p>In case the user doesn't want to retrieve the whole block, there is an option to retrieve only a subset of the available information, using filters. An array of AccessInfo.Fields can be included in the request selecting the desired info blocks:</p>
<div class="fragment"><pre class="fragment">AccessInfo getAccessInfo(AccessInfo.Fields[] fields) throws BlueviaException, IOException
</pre></div><h4><a class="anchor" id="user_access_info_code_example_sec"></a>
Code examples</h4>
<p>This is a example for retrieving the whole user access information block:</p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">try</span> {
        <span class="comment">//Get the AccessInfo response</span>
        AccessInfo accessInfo = directoryClient.getAccessInfo();

        <span class="comment">/* Get information and do stuff */</span>
          
} <span class="keywordflow">catch</span> (BlueviaException e) {
        log.error(<span class="stringliteral">&quot;Error getting access info&quot;</span>, e);
} <span class="keywordflow">catch</span> (IOException e) {
        log.error(<span class="stringliteral">&quot;Error getting access info&quot;</span>, e);
}
</pre></div><p>For filtering information, you have to include the fields you want to retrieve. This is an example:</p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">try</span> {
        <span class="comment">//Set the fields</span>
        AccessInfo.Fields[] fields = {Fields.ACCESS_TYPE, Fields.APN};
        
        <span class="comment">//Get the AccessInfo response</span>
        AccessInfo accessInfo = directoryClient.getAccessInfo(fields);

        <span class="comment">/* Get information and do stuff */</span>
        String accessType = accessInfo.getAccessType();
          
} <span class="keywordflow">catch</span> (BlueviaException e) {
        log.error(<span class="stringliteral">&quot;Error getting access info&quot;</span>, e);
} <span class="keywordflow">catch</span> (IOException e) {
        log.error(<span class="stringliteral">&quot;Error getting access info&quot;</span>, e);
}
</pre></div><h3><a class="anchor" id="retrieving_user_personal_info_sec"></a>
Retrieving user personal information</h3>
<p>This method retrieves the whole user personal information resource block from the directory. This block includes personal information about the user, such as the gender. The signature of the method is:</p>
<div class="fragment"><pre class="fragment">PersonalInfo getPersonalInfo() throws BlueviaException, IOException
</pre></div><p>Check the API Reference to see the information that can be obtained from the PersonalInfo returned object, accessible by getter methods.</p>
<h4><a class="anchor" id="user_personal_info_using_filters_sec"></a>
Using filters in requests</h4>
<p>In case the user doesn't want to retrieve the whole block, there is an option to retrieve only a subset of the available information, using filters. An array of PersonalInfo.Fields can be included in the request selecting the desired info blocks:</p>
<div class="fragment"><pre class="fragment">PersonalInfo getPersonalInfo(PersonalInfo.Fields[] fields) throws BlueviaException, IOException
</pre></div><h4><a class="anchor" id="user_personal_info_code_examples_sec"></a>
Code examples</h4>
<p>This is a example for retrieving the user personal info:</p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">try</span> {
        <span class="comment">//Get the PersonalInfo response</span>
        PersonalInfo personalInfo = directoryClient.getPersonalInfo();

        <span class="comment">/* Get information and do stuff */</span>
          
} <span class="keywordflow">catch</span> (BlueviaException e) {
        log.error(<span class="stringliteral">&quot;Error getting personal info&quot;</span>, e);
} <span class="keywordflow">catch</span> (IOException e) {
        log.error(<span class="stringliteral">&quot;Error getting personal info&quot;</span>, e);
}
</pre></div><p>For filtering information, you have to include the fields you want to retrieve. This is an example:</p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">try</span> {
        <span class="comment">//Set the fields</span>
        PersonalInfo.Fields[] fields = {Fields.GENDER};
        
        <span class="comment">//Get the PersonalInfo response</span>
        PersonalInfo personalInfo = directoryClient.getPersonalInfo(fields);

        <span class="comment">/* Get information and do stuff */</span>
        String gender = personalInfo.getGender();
          
} <span class="keywordflow">catch</span> (BlueviaException e) {
        log.error(<span class="stringliteral">&quot;Error getting personal info&quot;</span>, e);
} <span class="keywordflow">catch</span> (IOException e) {
        log.error(<span class="stringliteral">&quot;Error getting personal info&quot;</span>, e);
}
</pre></div><h3><a class="anchor" id="retrieving_user_terminal_info_sec"></a>
Retrieving user terminal information</h3>
<p>This method retrieves the whole user terminal information resource block from the directory. This block includes information about the terminal being used by the end-user. The signature of the method is:</p>
<div class="fragment"><pre class="fragment">TerminalInfo getTerminalInfo() throws BlueviaException, IOException
</pre></div><p>Check the API Reference to see the information that can be obtained from the TerminalInfo returned object, accessible by getter methods.</p>
<h4><a class="anchor" id="user_terminal_info_using_filters_sec"></a>
Using filters in requests</h4>
<p>In case the user doesn't want to retrieve the whole block, there is an option to retrieve only a subset of the available information, using filters. An array of TerminalInfo.Fields can be included in the request selecting the desired info blocks:</p>
<div class="fragment"><pre class="fragment">TerminalInfo getTerminalInfo(TerminalInfo.Fields[] fields) throws BlueviaException, IOException
</pre></div><h4><a class="anchor" id="user_terminal_info_code_examples_sec"></a>
Code examples</h4>
<p>This is a example for retrieving the user terminal info:</p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">try</span> {
        <span class="comment">//Get the TerminalInfo response</span>
        TerminalInfo terminalInfo = directoryClient.getTerminalInfo();

        <span class="comment">/* Get information and do stuff */</span>
          
} <span class="keywordflow">catch</span> (BlueviaException e) {
        log.error(<span class="stringliteral">&quot;Error getting terminal info&quot;</span>, e);
} <span class="keywordflow">catch</span> (IOException e) {
        log.error(<span class="stringliteral">&quot;Error getting terminal info&quot;</span>, e);
}
</pre></div><p>For filtering information, you have to include the fields you want to retrieve. This is an example:</p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">try</span> {
        <span class="comment">//Set the fields</span>
        TerminalInfo.Fields[] fields = {Fields.BRAND, Fields.MODEL, Fields.MMS, Fields.WAP, Fields.SCREEN_RESOLUTION};
        
        <span class="comment">//Get the TerminalInfo response</span>
        TerminalInfo terminalInfo = directoryClient.getTerminalInfo(fields);

        <span class="comment">/* Get information and do stuff */</span>
        String brand = terminalInfo.getBrand();
          
} <span class="keywordflow">catch</span> (BlueviaException e) {
        log.error(<span class="stringliteral">&quot;Error getting terminal info&quot;</span>, e);
} <span class="keywordflow">catch</span> (IOException e) {
        log.error(<span class="stringliteral">&quot;Error getting terminal info&quot;</span>, e);
}
</pre></div> </div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">Generated on Wed May 30 2012 15:09:20 for SDK by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
